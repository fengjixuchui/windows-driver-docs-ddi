---
UID: NS:bthddi._BRB_PSM
title: _BRB_PSM (bthddi.h)
description: The _BRB_PSM structure describes a Protocol/Service Multiplexer (PSM) to register or unregister.
old-location: bltooth\_brb_psm.htm
tech.root: bltooth
ms.assetid: 893edad2-8419-4c93-bf0b-2cca8ca5a2f6
ms.date: 04/27/2018
keywords: ["_BRB_PSM structure"]
ms.keywords: "_BRB_PSM, _BRB_PSM structure [Bluetooth Devices], bltooth._brb_psm, bth_structs_f40af07e-a5ad-4654-9ff6-4d162a46ea58.xml, bthddi/_BRB_PSM"
f1_keywords:
 - "bthddi/_BRB_PSM"
 - "_BRB_PSM"
req.header: bthddi.h
req.include-header: Bthddi.h
req.target-type: Windows
req.target-min-winverclnt: Versions:\_Supported in Windows Vista, and later.
req.target-min-winversvr: 
req.kmdf-ver: 
req.umdf-ver: 
req.ddi-compliance: 
req.unicode-ansi: 
req.idl: 
req.max-support: 
req.namespace: 
req.assembly: 
req.type-library: 
req.lib: 
req.dll: 
req.irql: 
topic_type:
- APIRef
- kbSyntax
api_type:
- HeaderDef
api_location:
- bthddi.h
api_name:
- _BRB_PSM
targetos: Windows
req.typenames: 
---

# _BRB_PSM structure


## -description


The _BRB_PSM structure describes a Protocol/Service Multiplexer (PSM) to register or
  unregister.


## -struct-fields




### -field Hdr

A 
     <a href="https://docs.microsoft.com/windows-hardware/drivers/ddi/bthddi/ns-bthddi-_brb_header">BRB_HEADER</a> structure that contains information
     about the current BRB.


### -field Psm

When the _BRB_PSM structure is passed as input for a 
     <a href="https://docs.microsoft.com/previous-versions/ff536621(v=vs.85)">BRB_REGISTER_PSM</a> BRB call, this is the PSM
     that the profile driver attempts to register. If the profile driver sets this value to zero, the PSM is
     dynamically generated. If the profile driver specified zero on <b>BRB_REGISTER_PSM</b> input, on output this
     member contains the PSM that was registered.
     

When the _BRB_PSM structure is passed as input for a 
     <a href="https://docs.microsoft.com/previous-versions/ff536632(v=vs.85)">BRB_UNREGISTER_PSM</a> BRB call, this is the
     PSM that the profile driver attempts to unregister. This value must be a PSM that is currently
     registered. For more information about valid PSM values, see the Remarks section.

Some PSMs are reserved for use by Windows:

SDP: 0x01

RFCOMM: 0x03

HID Control: 0x11

HID Data: 0x13

BNEP: 0x0F


## -remarks



To register a PSM, profile drivers should 
    <a href="https://docs.microsoft.com/previous-versions/ff536657(v=vs.85)">build and send</a> a 
    <a href="https://docs.microsoft.com/previous-versions/ff536621(v=vs.85)">BRB_REGISTER_PSM</a> request.

After a PSM has been registered, the profile driver can receive connection notifications from remote
    devices and can build and send 
    <a href="https://docs.microsoft.com/previous-versions/ff536616(v=vs.85)">
    BRB_L2CA_OPEN_CHANNEL_RESPONSE</a> requests to accept incoming connections.

The profile driver can specify a particular PSM or can request that a PSM be dynamically generated by
    specifying PSM_INVALID in the 
    <b>Psm</b> member. If the profile driver specifies PSM_INVALID, on output the PSM assigned will be
    returned in the 
    <b>Psm</b> member of the structure.

The Bluetooth driver stack registers PSMs for the following profiles: HCRP, HID, PAN, SDP, and
    RFCOMM.

For more information about L2CAP servers and PSMs, see 
    <a href="https://docs.microsoft.com/previous-versions/ff536572(v=vs.85)">Accepting
    L2CAP Connections in a Bluetooth Profile Driver</a>.

Profile drivers cannot register a PSM that has already been registered by another driver. If one
    attempts to do so, a STATUS_ALREADY_COMMITTED error will be returned. The <b>BRB_REGISTER_PSM</b> request has no
    effect on SDP records. After registering a PSM, drivers can advertise the PSM over SDP by sending the 
    <a href="https://docs.microsoft.com/windows-hardware/drivers/ddi/bthioctl/ni-bthioctl-ioctl_bth_sdp_submit_record">
    IOCTL_BTH_SDP_SUBMIT_RECORD</a> IOCTL.

To unregister a previously registered PSM, profile drivers should 
    <a href="https://docs.microsoft.com/previous-versions/ff536657(v=vs.85)">build and send</a> a 
    <a href="https://docs.microsoft.com/previous-versions/ff536632(v=vs.85)">BRB_UNREGISTER_PSM</a> request. Profile
    drivers must specify a PSM that is currently registered. If a profile driver sends a BRB_REGISTER_PSM
    request with a value of zero in the 
    <b>Psm</b> member, the dynamically assigned PSM value should be passed in the BRB_UNREGISTER_PSM
    request.

A <b>BRB_UNREGISTER_PSM</b> request has no effect on SDP records that attempt to connect to the PSM. Profile
    drivers can remove relevant SDP records by sending the 
    <a href="https://docs.microsoft.com/windows-hardware/drivers/ddi/bthioctl/ni-bthioctl-ioctl_bth_sdp_remove_record">
    IOCTL_BTH_SDP_REMOVE_RECORD</a> IOCTL.




## -see-also




<a href="https://docs.microsoft.com/windows-hardware/drivers/ddi/bthddi/ns-bthddi-_brb_header">BRB_HEADER</a>



<a href="https://docs.microsoft.com/previous-versions/ff536616(v=vs.85)">
   BRB_L2CA_OPEN_CHANNEL_RESPONSE</a>



<a href="https://docs.microsoft.com/previous-versions/ff536621(v=vs.85)">BRB_REGISTER_PSM</a>



<a href="https://docs.microsoft.com/previous-versions/ff536632(v=vs.85)">BRB_UNREGISTER_PSM</a>



<a href="https://docs.microsoft.com/windows-hardware/drivers/ddi/bthioctl/ni-bthioctl-ioctl_bth_sdp_remove_record">IOCTL_BTH_SDP_REMOVE_RECORD</a>



<a href="https://docs.microsoft.com/windows-hardware/drivers/ddi/bthioctl/ni-bthioctl-ioctl_bth_sdp_submit_record">IOCTL_BTH_SDP_SUBMIT_RECORD</a>
 

 

